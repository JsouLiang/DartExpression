import 'package:Expression/Expression.dart';
import 'package:test/test.dart';
import 'dart:convert';
import 'dart:developer';

void main() {
  group('A group of tests', () {


    setUp(() {
    });

    test('First Test', () {
//      List<String> result = "1.2,3".split(RegExp(r"[.]|,")); // 将点括起来表示普通的点，而不是代表任意字符
//      print(result);
      String templateString = '''
      ["view",2,["class","container"],[["view",2,["class","header"],[["view",2,["class","userInfoContainer"],[["view",2,["class","avatarContainer","bindtap","tapTask"],[["image",1,["class","avatarImg","src",[[-2,"avatarImgURL"],{"avatarImgURL":[""]}]],[],{}],["image",1,["class","levelImage","src",[[84,[84,[-1,"../images/icon_mine_level"],[-2,"growthlevel"]],[-1,"@2x.png"]],{"growthlevel":[""]}]],[],{}]],{}],["text",2,["class","userName"],[["#",1,[[-2,"userName"],{"userName":[""]}]]],{}],["text",2,["class","userGrownInfo","bindtap","memberStrategy"],[["#",1,[[84,[84,[-1,"成长值："],[-2,"growthValue"]],[-1," | "]],{"growthValue":[""]}]],["text",2,["bindtap","tapVIP"],[["#",1,[[84,[-1,"积分："],[-2,"pointValue"]],{"pointValue":[""]}]]],{}]],{}]],{}]],{}],["view",2,["class","userLevel"],[["view",0,[],[["view",0,["class","descript"],[["text",0,["class","grayDescript"],[["#",0,"我的会员"]],{}],["view",0,["style","display:flex; flex-direction:row; align-items: center;","bindtap","memberStrategy"],[["text",0,["class","grayDescript"],[["#",0,"会员攻略"]],{}],["image",0,["src","../images/right.png","style","margin-left:10rpx;width:15rpx; height:20rpx"],[],{}]],{}]],{}],["view",0,["class","separateLine"],[],{}]],{}],["view",2,["class","levelProgressContainer"],[["view",3,["style",[[84,[84,[-1,"transform: translateX("],[85,[-2,"progressPercent"],[-1,10]]],[-1,"%);"]],{"progressPercent":[""]}]],[["text",2,["class","growthValue"],[["#",1,[[-2,"animatedGrowthValue"],{"animatedGrowthValue":[""]}]],["text",2,["class","wholeValue"],[["#",1,[[84,[-1,"/"],[84,[-2,"deltaGrowthValue"],[-2,"growthValue"]]],{"deltaGrowthValue":[""],"growthValue":[""]}]]],{}]],{}]],{}],["view",2,["class","progressContainer"],[["view",1,["class","progressActiveBar","style",[[84,[84,[-1,"width:"],[-2,"progressPercent"]],[-1,"%"]],{"progressPercent":[""]}]],[],{}]],{}],["view",2,["class","levels"],[["block",2,["action","for","value",[[64,[64,[64,[64,[64,[64,[64,[-3],[-1,0]],[-1,1]],[-1,2]],[-1,3]],[-1,4]],[-1,5]],[-1,6]],{}],"for-item","levelIndex","for-index","index","key",[[-2,"levelIndex"],{"levelIndex":[""]}]],[["image",1,["class","levelImg","src",[[84,[84,[84,[-1,"../images/icon_level_"],[-2,"levelIndex"]],[69,[68,[77,[-2,"levelIndex"],[-2,"animatedRealLevelIndex"]],[-1,"_gray"]],[-1,""]]],[-1,"@2x.png"]],{"levelIndex":[""],"animatedRealLevelIndex":[""]}]],[],{}]],{}]],{}],["text",2,["class","levelDesc"],[["#",0,"距离下一等级还需要"],["text",2,["class","levelScore"],[["#",1,[[84,[84,[-1," "],[-2,"deltaGrowthValue"]],[-1," "]],{"deltaGrowthValue":[""]}]]],{}],["#",0,"成长值"]],{}]],{}]],{}],["view",2,["class","userRightContainer"],[["view",0,[],[["view",0,["class","descript"],[["text",0,["class","grayDescript"],[["#",0,"我的会员"]],{}],["view",0,["style","display:flex; flex-direction:row; align-items: center;","bindtap","tapCategory"],[["text",0,["class","grayDescript"],[["#",0,"查看全部"]],{}],["image",0,["src","../images/right.png","style","margin-left:10rpx;width:15rpx; height:20rpx"],[],{}]],{}]],{}],["view",0,["class","separateLine"],[],{}]],{}],["view",2,["class","rightCategory"],[["block",2,["action","for","value",[[-2,"privileges"],{"privileges":[""]}],"for-item","privilege","for-index","index","key",[[96,[-2,"privilege"],[-1,"title"]],{"privilege":["title"]}]],[["view",2,["class","category","bindtap","tapCategory"],[["image",1,["class","categoryImg","src",[[96,[-2,"privilege"],[-1,"icon"]],{"privilege":["icon"]}]],[],{}],["text",2,["class","title"],[["#",1,[[96,[-2,"privilege"],[-1,"title"]],{"privilege":["title"]}]]],{}]],{}]],{}]],{}]],{}],["view",2,["class","grownTaskContainer"],[["view",0,["style","background-color:white"],[["view",0,["class","descript"],[["text",0,["class","grayDescript"],[["#",0,"成长任务"]],{}]],{}],["view",0,["class","separateLine"],[],{}]],{}],["block",2,["action","for","value",[[-2,"grownTasks"],{"grownTasks":[""]}],"for-item","grownTask","for-index","index","key",[[96,[-2,"grownTask"],[-1,"taskId"]],{"grownTask":["taskId"]}]],[["view",2,[],[["view",2,["style","background-color:white"],[["view",2,["class","taskContainer"],[["view",2,["class","taskInfo"],[["text",2,["class","taskTitle"],[["#",1,[[96,[-2,"grownTask"],[-1,"title"]],{"grownTask":["title"]}]]],{}],["text",2,["class","taskAward"],[["#",1,[[96,[-2,"grownTask"],[-1,"desc"]],{"grownTask":["desc"]}]]],{}]],{}],["view",3,["class",[[84,[-1,"taskFinishedStyle "],[69,[68,[76,[96,[-2,"grownTask"],[-1,"status"]],[-1,0]],[-1,"taskNormal"]],[69,[68,[76,[96,[-2,"grownTask"],[-1,"status"]],[-1,1]],[-1,"taskRewardStyle"]],[-1,""]]]],{"grownTask":["status"]}],"bindtap","tapTask","data-task",[[-2,"grownTask"],{"grownTask":[""]}],"data-taskindex",[[-2,"index"],{"index":[""]}]],[["text",3,["class",[[84,[-1,"btnTitle "],[69,[68,[76,[96,[-2,"grownTask"],[-1,"status"]],[-1,0]],[-1,"normalTitle"]],[69,[68,[76,[96,[-2,"grownTask"],[-1,"status"]],[-1,1]],[-1,"taskRewardTitle"]],[-1,""]]]],{"grownTask":["status"]}]],[["#",1,[[84,[96,[-2,"grownTask"],[-1,"actionButtonTitle"]],[-1," "]],{"grownTask":["actionButtonTitle"]}]]],{}]],{}]],{}],["view",0,["class","separateLine"],[],{}]],{}]],{}]],{}]],{}]],{}]
      ''';
      String contextStr = '''
      {"unavailable":["1","2","3"],"realLevelIndex":3,"animatedRealLevelIndex":0,"avatarImgURL":"https://img.meituan.net/avatar/4dd744392d37fedc8ca8173aabe0df6f255363.jpg","userName":"Jsoulan","growthValue":2419,"animatedGrowthValue":0,"deltaGrowthValue":581,"growthlevel":3,"pointValue":0,"progressPercent":61.82500000000001,"privileges":[{"desc":"身份的象征，彰显您的会员身份！会随着等级不同发生变化，当真是牛逼闪闪的身份铭牌！","icon":"http://p1.meituan.net/mmc/f8f3a93da44829a77315fbdbb612f0a71921.png","title":"身份铭牌","id":2},{"desc":"谁说积分不能当钱花？在美团，积分就是可以当钱花！每个订单能使用积分抵扣的金额都不同，快去试试！积分抵现仅支持部分团购订单，具体以提单页实际为准。","icon":"http://p1.meituan.net/mmc/0ad0356bdcccb349681d71784ece92902624.png","title":"积分抵现","id":3},{"desc":"美团宴请小伙伴，霸王餐内会出现按等级用户专门试吃活动哟~而且部分小伙伴还可以突然获得一张免单体验券哟！","icon":"http://p1.meituan.net/mmc/cef37956225337139669ace454272dbb1660.png","title":"免费试吃","id":6}],"unavailablePrivileges":[{"desc":"不小心买错了？突然改变主意了？都不要紧！立刻为你退款！如此特权，还会害怕买错团购嘛？极速退款支持类型：团购订单、美团券，酒店和旅游订单暂不支持。","icon":"http://p1.meituan.net/mmc/703c6db43b0f8acebf2a3a01d60beaa82262.png","title":"极速退款","id":8},{"desc":"拒绝等待，作为最尊贵的会员，美团客服将优先为您处理您的问题。","icon":"http://p1.meituan.net/mmc/519e5cb2ff413ef44610c962938499f12746.png","title":"客服优先接入","id":9}],"grownTasks":[{"desc":"+15成长值","taskId":3,"title":"初次绑定手机","uri":"imeituan://www.meituan.com/account","status":2,"actionButtonTitle":"已领取"},{"desc":"+10成长值","taskId":6,"title":"上传头像","uri":"imeituan://www.meituan.com/userinfo","status":2,"actionButtonTitle":"已领取"},{"desc":"+10成长值","taskId":7,"title":"设置用户名","uri":"imeituan://www.meituan.com/userinfo","status":2,"actionButtonTitle":"已领取"}],"prevDesc":"距离下一等级还需要","deltaGrowthValueStr":581,"grownDesc":"成长值","levelImage":"../","normalTaskStyle":"taskNormal","normalTaskTitleStyle":"normalTitle","names":["Tom","Bill","Dash"],"__webviewId__":55}
      ''';
      List<dynamic> result = JsonDecoder().convert(templateString);
      Map<String, dynamic> context = JsonDecoder().convert(contextStr);
      var begine =  DateTime.now();
      Render(result, context);
      var end = DateTime.now();
      print(end.difference(begine).inMilliseconds);
//      List<List<dynamic>> children = result[3] as List<List<dynamic>>;
//      for (List<> child in result[3]) {
//
//      }
//      print(result);
    });
  });
}
